Metadata-Version: 2.4
Name: blackbox-data
Version: 0.1.0
Summary: Forensic recorder for Pandas data pipelines (closed MVP)
Author: Salman Shakeeb
License: MIT
Project-URL: Repository, https://github.com/shakeeb1532/blackbox-data
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: pandas>=2.0
Requires-Dist: pyarrow>=14.0
Requires-Dist: typer>=0.9
Requires-Dist: rich>=13.0
Provides-Extra: s3
Requires-Dist: boto3>=1.28; extra == "s3"
Provides-Extra: pro
Requires-Dist: fastapi>=0.110; extra == "pro"
Requires-Dist: uvicorn>=0.27; extra == "pro"
Requires-Dist: python-multipart>=0.0.9; extra == "pro"

# blackbox-data

Blackbox Data is a lightweight, tamper-evident forensic recorder for pandas data pipelines.

It records:
- step-by-step input/output dataset fingerprints
- optional snapshot artifacts (Parquet) with size controls
- primary-key based diffs (added/removed/changed)
- schema diffs (added/removed/dtype changes)
- a tamper-evident hash chain you can verify later

This is an MVP intended for:
- data teams who need auditability for ETL/feature pipelines
- reproducibility and “what changed?” reporting between pipeline stages
- evidence-grade run logs during incidents and investigations

## Features (MVP)
- **Run + Steps**: structured `run.json`, per-step `step.json`
- **Schema diff**: added/removed columns, dtype changes
- **Rowhash diff (PK-based)**: added/removed/changed keys
- **Snapshots**: Parquet artifacts with `none/auto/always` and max size
- **Tamper-evident chain**: `chain.json` with payload digests and head
- **CLI**: list runs, verify chain, report run (human + JSON)

## Install (GitHub)
```bash
git clone https://github.com/<your-user>/blackbox-data.git
cd blackbox-data
python3 -m venv .venv
source .venv/bin/activate
python3 -m pip install -U pip
python3 -m pip install -e .
Quickstart Demo
Run the included demo which generates a local store and prints a report.

bash
Copy code
python examples/demo.py
Then list and report using the CLI:

bash
Copy code
blackbox --root ./.blackbox_store list --project acme-data --dataset demo
blackbox --root ./.blackbox_store report --project acme-data --dataset demo --run-id <RUN_ID>
blackbox --root ./.blackbox_store verify --project acme-data --dataset demo --run-id <RUN_ID>
Store layout (local)
A run writes keys under:

pgsql
Copy code
<root>/<project>/<dataset>/<run_id>/
  run.json
  run_start.json
  run_finish.json
  chain.json
  events.jsonl (optional)
  steps/<ordinal>_<name>/
    step.json
    artifacts/
      input*.bbdata
      output*.bbdata
      diff.bbdelta (if diff enabled)
Usage (Python)
python
Copy code
import pandas as pd
from blackbox import Recorder, Store, DiffConfig, SnapshotConfig, SealConfig

store = Store.local("./.blackbox_store")
rec = Recorder(
    store=store,
    project="acme-data",
    dataset="demo",
    diff=DiffConfig(mode="rowhash", primary_key=["id"]),
    snapshot=SnapshotConfig(mode="auto", max_mb=5),
    seal=SealConfig(mode="chain"),
)

run = rec.start_run(tags={"env": "local"}, metadata={"owner": "you"})

df0 = pd.DataFrame({"id":[1,2,3], "score":[10,20,30]})

with run.step("normalize", input_df=df0) as st:
    df1 = df0.copy()
    df1["score"] = df1["score"] / 10.0
    st.capture_output(df1)

run.finish()
ok, msg = run.verify()
print(ok, msg)
